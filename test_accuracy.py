import matplotlib.pyplot as plt 
import os
import joblib
import numpy as np
from scipy.io import loadmat
import time
import pickle
import argparse
from sklearn.pipeline import make_pipeline
import random
import pandas as pd
from MyFunctions import *

X_train_ori =  loadmat("./mat_files/MNIST.mat")["train_x"].astype(np.float32)

test = loadmat("./mat_files/MNIST.mat")["train_y"].astype(np.float32)

x = np.array([X_train_ori[:,1],
              X_train_ori[:,3],
              X_train_ori[:,5],
              X_train_ori[:,30],
              X_train_ori[:,2],
              X_train_ori[:,0],
              X_train_ori[:,13],
              X_train_ori[:,15],
              X_train_ori[:,31],
              X_train_ori[:,4]])

test_accuracy = [82.64, 84.99, 86,  86.49, 86.45]

S_hat = sorted_ind = [507,404,408,244,320,239,297,327,400,351,512,489,369,238,330,457,273,289,454,359,378,153,156,659,605,348,293,412,465,519,463,371,423,258,572,481,549,650,346,398,290,443,594,235,175,485,429,402,370,597,487,323,275,353
    ,217,663,389,211,569,607,355,405,261,582,599,496,247,177,319,410,513,564,538,436,494,314,352,537,209,210,154,495,264,662,631,295,575,510,368,441,212,181,231,406,536,265,396,190,274,427,514,241,321,456,553,299,326,425
    ,318,416,350,451,240,486,216,500,206,524,328,381,526,654,552,499,388,315,455,576,633,656,286,395,651,627,554,202,229,622,317,657,233,492,272,570,470,459,540,245,413,242,155,490,603,608,452,652,403,379,625,302,296,377
    ,601,347,380,508,291,257,581,573,305,484,414,437,292,357,161,341,246,407,497,214,285,182,600,208,442,325,539,520,189,546,483,479,303,511,284,433,515,356,550,517,266,354,180,215,431,304,541,232,332,629,493,399,340,276
    ,345,542,360,595,158,248,415,344,551,593,453,626,383,387,567,630,185,635,580,480,527,632,525,300,469,555,548,270,428,464,658,179,491,598,183,660,373,385,384,267,243,461,374,518,444,424,268,184,375,312,430,574,440,604
    ,568,566,578,432,468,516,434,426,401,471,439,313,262,521,236,653,349,376,237,634,579,298,624,219,159,333,435,204,331,623,287,544,522,372,386,207,157,361,438,571,343,466,259,271]
show_image_accuracy(x, S_hat[0:300], "test_nmp_300_1x1_accuracy", test_accuracy)